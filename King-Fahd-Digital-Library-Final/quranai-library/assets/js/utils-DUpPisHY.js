var a=(i,e,t)=>new Promise((s,n)=>{var d=r=>{try{m(t.next(r))}catch(p){n(p)}},g=r=>{try{m(t.throw(r))}catch(p){n(p)}},m=r=>r.done?s(r.value):Promise.resolve(r.value).then(d,g);m((t=t.apply(i,e)).next())});var f={};class c{constructor(){this.errors=[],this.maxErrors=1e3,this.apiEndpoint=f.REACT_APP_ERROR_REPORTING_URL||"",this.setupGlobalErrorHandlers()}static getInstance(){return c.instance||(c.instance=new c),c.instance}setupGlobalErrorHandlers(){window.addEventListener("error",e=>{var t;this.captureError({message:e.message,stack:(t=e.error)==null?void 0:t.stack,component:"Global",timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href,severity:"high"})}),window.addEventListener("unhandledrejection",e=>{var t;this.captureError({message:`Unhandled Promise Rejection: ${e.reason}`,stack:(t=e.reason)==null?void 0:t.stack,component:"Promise",timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href,severity:"high"})})}captureError(e){this.errors.push(e),this.errors.length>this.maxErrors&&(this.errors=this.errors.slice(-this.maxErrors));try{localStorage.setItem("app_errors",JSON.stringify(this.errors))}catch(t){console.warn("Failed to store errors in localStorage:",t)}this.apiEndpoint&&this.sendToMonitoringService(e)}sendToMonitoringService(e){return a(this,null,function*(){try{yield fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.warn("Failed to send error to monitoring service:",t)}})}getErrors(){return[...this.errors]}clearErrors(){this.errors=[],localStorage.removeItem("app_errors")}getErrorStats(){const e=this.errors.reduce((t,s)=>(t[s.severity]=(t[s.severity]||0)+1,t),{});return{total:this.errors.length,bySeverity:e,lastError:this.errors[this.errors.length-1]}}}class o{constructor(){this.metrics=new Map}static getInstance(){return o.instance||(o.instance=new o),o.instance}startTiming(e){performance.mark(`${e}-start`)}endTiming(e){performance.mark(`${e}-end`),performance.measure(e,`${e}-start`,`${e}-end`);const t=performance.getEntriesByName(e)[0];if(t){const s=this.metrics.get(e)||[];s.push(t.duration),this.metrics.set(e,s)}}getMetrics(){const e={};return this.metrics.forEach((t,s)=>{e[s]={avg:t.reduce((n,d)=>n+d,0)/t.length,min:Math.min(...t),max:Math.max(...t),count:t.length}}),e}}class h{constructor(){this.events=[]}static getInstance(){return h.instance||(h.instance=new h),h.instance}track(e,t={}){const s={event:e,data:t,timestamp:Date.now()};this.events.push(s),this.events.length>1e3&&(this.events=this.events.slice(-1e3)),this.sendToAnalytics(s)}sendToAnalytics(e){return a(this,null,function*(){console.log("Analytics Event:",e)})}getEvents(){return[...this.events]}}class l{constructor(){this.checks=[]}static getInstance(){return l.instance||(l.instance=new l),l.instance}addCheck(e,t){this.checks.push({name:e,check:t})}runChecks(){return a(this,null,function*(){return(yield Promise.allSettled(this.checks.map(n=>a(this,[n],function*({name:t,check:s}){return{name:t,status:(yield s())?"healthy":"unhealthy"}})))).map((t,s)=>({name:this.checks[s].name,status:t.status==="fulfilled"?t.value.status:"error",error:t.status==="rejected"?t.reason:void 0}))})}}const w=()=>{const i=c.getInstance(),e=o.getInstance(),t=h.getInstance(),s=l.getInstance();return s.addCheck("localStorage",()=>a(null,null,function*(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(n){return!1}})),s.addCheck("fetch",()=>a(null,null,function*(){try{return yield fetch("/health",{method:"HEAD"}),!0}catch(n){return!1}})),{errorMonitor:i,performanceTracker:e,userAnalytics:t,healthChecker:s}};class u{constructor(){this.cache=new Map,this.maxSize=1e3,this.defaultTTL=300*1e3}static getInstance(){return u.instance||(u.instance=new u),u.instance}set(e,t,s){const n={data:t,timestamp:Date.now(),ttl:s||this.defaultTTL};if(this.cache.size>=this.maxSize){const d=this.cache.keys().next().value;this.cache.delete(d)}this.cache.set(e,n)}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data:null}has(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),!1):!0:!1}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}size(){return this.cache.size}cleanup(){const e=Date.now();for(const[t,s]of this.cache.entries())e-s.timestamp>s.ttl&&this.cache.delete(t)}getStats(){const e=Date.now();let t=0,s=0;for(const n of this.cache.values())e-n.timestamp>n.ttl?t++:s++;return{total:this.cache.size,valid:s,expired:t,hitRate:0}}}const y=()=>{const i=u.getInstance();setInterval(()=>{i.cleanup()},300*1e3)},E=()=>{["/images/quran-complex-logo.png","/audio/sample1.wav","/audio/sample2.wav","/audio/sample3.wav"].forEach(e=>{const t=document.createElement("link");t.rel="preload",t.href=e,t.as=e.endsWith(".png")?"image":"audio",document.head.appendChild(t)})};export{y as a,w as i,E as p};
